

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Work with reference data &mdash; KBase SDK 0.1.18 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Anatomy of an App" href="../references/module_anatomy.html" />
    <link rel="prev" title="Run shell commands in your app" href="run_a_shell_command.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> KBase SDK
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Intro</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Concepts and Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../video_tutorial.html">Video Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/dependencies.html">1. Dependencies &amp; Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/install.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/initialize.html">3. Initialize the App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/setup.html">4. Setup &amp; Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/implement.html">5. Implement Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/publish.html">6. Publish and Test</a></li>
</ul>
<p class="caption"><span class="caption-text">How-to Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="create_a_report.html">Create a report</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_ui_elements.html">Add UI elements to your app</a></li>
<li class="toctree-l1"><a class="reference internal" href="edit_your_dockerfile.html">Edit your app’s Dockerfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="fill_out_app_information.html">Complete your app’s publish data</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_build.html">Manually build the SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_a_shell_command.html">Run shell commands in your app</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Work with reference data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#adding-reference-data-to-a-kbase-app">Adding Reference Data to a KBase App</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-reference-data-works">How Reference Data works</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-reference-data">Updating Reference Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gotchas">Gotchas</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">References &amp; Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references/module_anatomy.html">Anatomy of an App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/troubleshooting.html">Troubleshooting Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/dev_guidelines.html">Developer Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/KIDL_spec.html">KIDL Specification</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">KBase SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Work with reference data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com////howtos/work_with_reference_data.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="work-with-reference-data">
<h1>Work with reference data<a class="headerlink" href="#work-with-reference-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="adding-reference-data-to-a-kbase-app">
<h2>Adding Reference Data to a KBase App<a class="headerlink" href="#adding-reference-data-to-a-kbase-app" title="Permalink to this headline">¶</a></h2>
<p>Motivation <sub>:sub:</sub><sub>:sub:</sub><sub>~````</sub>~~</p>
<p>Some tools and applications make use of large reference data
collections. For example, a QC app may have a reference data with common
contaminants. Adding data such as this to the Git repo for the module
can make it very large. In addition, the generated Docker image would
also be very large. KBase App reference data is designed to address this
scenario.</p>
</div>
<div class="section" id="how-reference-data-works">
<h2>How Reference Data works<a class="headerlink" href="#how-reference-data-works" title="Permalink to this headline">¶</a></h2>
<p>To minimize the image size, this feature works by saving reference data
in a special volume space and then making that volume available through
a read-only mount in /data at app execution time. An init mode for the
module is run at registration time to initialize the reference data
volume. In addition, the reference data is separately versioned, so
code-only updates to a module can be made without having to
re-initialize the reference data.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To make use of this feature, the app developer needs to do a few simple
things.</p>
<ol class="arabic simple">
<li>Add the data-version tag to the kbase.yaml file and give it a
semantic version tag.</li>
<li>Add any downloading and data preparation steps to the init section of
the entrypoint.sh script in the scripts directory. The init script
should place the data in /data and any apps that use the data should
be configured to look for the data in this location.</li>
<li>Create a __READY__ file in /data to indicate that the reference
data volume was successfully created. Ideally, some sanity tests
should be performed to confirm things ran correctly by testing for
the presence of expected files. If the __READY__ file is not
present, the registration will fail and the reference data area will
be removed.</li>
</ol>
<p>You can see an example in the RAST application:
<a class="reference external" href="https://github.com/kbaseapps/RAST_SDK/blob/a975436d9c0af4f772bd7235b467180860f64060/scripts/entrypoint.sh#L18-L28">https://github.com/kbaseapps/RAST_SDK/blob/a975436d9c0af4f772bd7235b467180860f64060/scripts/entrypoint.sh#L18-L28</a></p>
</div>
<div class="section" id="updating-reference-data">
<h2>Updating Reference Data<a class="headerlink" href="#updating-reference-data" title="Permalink to this headline">¶</a></h2>
<p>If a new version of reference data is required, the developer can
increase the version number for the reference data in kbase.yaml, make
any updates to the init section, and re-register the app. This will
trigger the registration to initialize the reference data for the new
data version. Older versions of the app will continue to use the
previous reference data specified in that versions kbase.yaml file. This
helps to ensure reproducibility.</p>
</div>
<div class="section" id="gotchas">
<h2>Gotchas<a class="headerlink" href="#gotchas" title="Permalink to this headline">¶</a></h2>
<p>There a few things to watch out for with reference data:</p>
<ul class="simple">
<li>The reference data area (/data) is mounted during initialization
(module registration) and durinng app execution and replaces /data
from the Docker image. Any modifications made by the Dockerfile to
this space will not be visible. Changes must be done in the init
block in entrypoint.sh.</li>
<li>The reference data is only writeable at registration time. This is to
ensure that the data is not accidentally changed during execution
which could break reproducibility. If the app requires the reference
data to be writeable when it executes, then you add code to the
execution that copies the data into the writeable work area prior to
running the underlying application.</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../references/module_anatomy.html" class="btn btn-neutral float-right" title="Anatomy of an App" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="run_a_shell_command.html" class="btn btn-neutral" title="Run shell commands in your app" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, KBase.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.18',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>